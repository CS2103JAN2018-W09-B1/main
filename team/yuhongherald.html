<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Yu Hong Herald - Project Portfolio</title>
<link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>Yu Hong Herald - Project Portfolio</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="project-carvicim"><a class="link" href="#project-carvicim">Project: CarviciM</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overview"><a class="link" href="#overview">Overview</a></h3>
<div class="imageblock" style="text-align: left">
<div class="content">
<img src="../images/CarviciM_logo.PNG" alt="CarviciM logo" width="150">
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/CS2103JAN2018-W09-B1/main">CarviciM</a> is a fast and robust desktop application for car servicing managers
monitoring and approving large volumes of job entries. It features importing
job entries from excel files, displaying job entries as eas-to-read-cards and
the ability to send reminders to employees through email.</p>
</div>
<div class="paragraph">
<p>Built on the <a href="https://github.com/nus-cs2103-AY1718S2/addressbook-level4">AddressBook - Level 4</a> project, which is used for teaching Software Engineering principles.
the application uses JavaFX to create a Guided User Interface (GUI) with a Command Line Interface (CLI) as the main
medium of interaction. It is written in Java, and has about 10 kLoC.</p>
</div>
<div class="paragraph">
<p>This portfolio acts as a summary of my contributions to CarviciM. It showcases the software engineering skills acquired and applied throughout the project.</p>
</div>
</div>
<div class="sect2">
<h3 id="summary-of-contributions"><a class="link" href="#summary-of-contributions">Summary of contributions</a></h3>
<div class="ulist">
<ul>
<li>
<p><strong>Major enhancement</strong>: added the ability to import job entries from an excel file</p>
<div class="ulist">
<ul>
<li>
<p>What it does: allows the user to collate job entries from different people in the form of excel files.
Also allows discrete accepting and rejecting of job entries, with autosave and a system to feedback to
excel file providers.</p>
</li>
<li>
<p>Justification: A significant improvement to CarviciM by simplifying collation of job entries
from different sources, which managers often do from admins, hence saving time and effort.</p>
</li>
<li>
<p>Highlights: This enhancement handles IOException thoroughly. Job entries with empty
fields will inherit their empty fields from the previous entry. Column headers does not enforce strict order.</p>
</li>
<li>
<p>Credits: Apache POI and POI-ooxml library are used to support excel file handling.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Minor enhancement</strong>: added a set command that allows the user to have a customized set of keywords as an
alternative to the original.</p>
</li>
<li>
<p><strong>Code contributed</strong>:
[<a href="https://github.com/CS2103JAN2018-W09-B1/main/blob/master/collated/functional/yuhongherald.md">Functional code</a>]
[<a href="https://github.com/CS2103JAN2018-W09-B1/main/blob/master/collated/test/yuhongherald.md">Test code</a>]</p>
</li>
<li>
<p><strong>Other contributions</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Project management:</p>
<div class="ulist">
<ul>
<li>
<p>Helped to edit PRs for merging
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/40">#40</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Improving UI design</p>
<div class="ulist">
<ul>
<li>
<p>Resized the UI Panels and application window so that they fit nicely
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/152">#151</a></p>
</li>
<li>
<p>Added JobListPanel to support displaying jobs
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/53">#53</a>
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/65">#65</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Documentation:</p>
<div class="ulist">
<ul>
<li>
<p>Added section on editing JavaFX <a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/154">#154</a></p>
</li>
<li>
<p>Added section on keeping working directory clean <a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/161">#161</a></p>
</li>
<li>
<p>Added missing details in User Guide and Developer Guide
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/4">#4</a>
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/29">#29</a>
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/4">#30</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Community:</p>
<div class="ulist">
<ul>
<li>
<p>PRs reviewed (with non-trivial review comments):
<a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/73">#73</a></p>
</li>
<li>
<p>Reported bugs and suggestions for other teams in the class
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/133">#133</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/134">#134</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/135">#135</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/140">#140</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/145">#145</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/147">#147</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/148">#148</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/151">#151</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/153">#153</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/155">#155</a>
<a href="https://github.com/CS2103JAN2018-F14-B1/main/issues/159">#159</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Tools:</p>
<div class="ulist">
<ul>
<li>
<p>Integrated 2 third party libraries (Apache POI, Apache Commons) to the project</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="contributions-to-the-user-guide"><a class="link" href="#contributions-to-the-user-guide">Contributions to the User Guide</a></h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections I contributed to the User Guide. They showcase my ability to write documentation targeting end-users.</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="changing-a-command-word-code-set-code"><a class="link" href="#changing-a-command-word-code-set-code">Changing a command word : <code>set</code></a></h3>
<div class="paragraph">
<p>To set an easy to use word in place of a default command word, use this command as follows:<br>
Format: <code>set OLD_COMMAND_WORD NEW_COMMAND_WORD</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The OLD_COMMAND_WORD can be either a default command word or one which user has set previously.</p>
</li>
<li>
<p>The NEW_COMMAND_WORD must be 1 word, with no spacing.</p>
</li>
<li>
<p>Any default words or custom words already in use are not allowed.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>To remove the custom word associated with a command, type the custom word as OLD_COMMAND_WORD and
COMMAND_WORD of the command as <code>newWord</code></p>
<div class="paragraph">
<p>e.g.</p>
</div>
<div class="paragraph">
<p><code>set adde a</code></p>
</div>
<div class="paragraph">
<p>To remove <code>a</code>, type:</p>
</div>
<div class="paragraph">
<p><code>set a adde</code></p>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You don&#8217;t have to worry if you forgot your custom words! They will be displayed in the result display
whenever you make a mistake!</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Example 1:<br></p>
<div class="paragraph">
<p><code>set adde a</code><br>
Sets <code>adde</code> command word to <code>a</code> using default.<br>
You will see "a has been set as an alternative for adde!" in the result display.</p>
</div>
</li>
<li>
<p>Example 2:<br></p>
<div class="paragraph">
<p><code>set deletee d</code><br>
<code>set d delete</code><br>
Sets <code>d</code> to <code>delete</code> using default.<br>
You will see "d has been replaced with delete!" in the result display.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="importing-jobs-from-an-excel-file-code-importall-code-code-import-code-code-accept-code-code-reject-code-code-acceptall-code-code-rejectall-code-code-switch-code"><a class="link" href="#importing-jobs-from-an-excel-file-code-importall-code-code-import-code-code-accept-code-code-reject-code-code-acceptall-code-code-rejectall-code-code-switch-code">Importing jobs from an excel file <code>importAll</code>, <code>import</code>, <code>accept</code>, <code>reject</code>, <code>acceptAll</code>, <code>rejectAll</code>, <code>switch</code></a></h3>
<div class="sect3">
<h4 id="importing-and-accepting-all-job-entries-in-an-excel-file-code-importall-code"><a class="link" href="#importing-and-accepting-all-job-entries-in-an-excel-file-code-importall-code">Importing and accepting all job entries in an excel file: <code>importAll</code></a></h4>
<div class="paragraph">
<p>To import all jobs into CarviciM directly, use this command as follows:
Format: <code>importAll FILEPATH</code></p>
</div>
<div class="paragraph">
<p>Similar to <a href="#import-command"><code>import</code></a> command, <code>importAll</code> also loads an excel file,
additionally it accepts all job entries. <code>importAll</code> is equivalent to an
<a href="#import-command"><code>import</code></a> and <a href="#acceptAll-command"><code>acceptAll</code></a>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>importAll excel-file.xlsx</code><br>
Imports example excel file excel-file.xlsx shown in <a href="#import-command"><code>import</code></a>, accepts all job entries and saves the reviewed job entries as an external excel file.
You should see:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/importAll-example.png" alt="importAll example" width="1200">
</div>
</div>
</div>
<div class="sect3">
<h4 id="importing-job-entries-discretely-code-import-code-code-accept-code-code-reject-code-code-acceptall-code-code-rejectall-code-code-switch-code"><a class="link" href="#importing-job-entries-discretely-code-import-code-code-accept-code-code-reject-code-code-acceptall-code-code-rejectall-code-code-switch-code">Importing job entries discretely <code>import</code>, <code>accept</code>, <code>reject</code>, <code>acceptAll</code>, <code>rejectAll</code>, <code>switch</code></a></h4>
<div class="paragraph">
<p>To discretely import job entries, here are the steps you should follow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#import-command">import</a> a file</p>
</li>
<li>
<p><a href="#accept-reject"><code>accept</code> and <code>reject</code></a> job entries.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="import-command"><a class="link" href="#import-command">Importing a new excel file: <code>import</code></a></h5>
<div class="paragraph">
<p>To start import a file, use this command as follows:<br>
Format: <code>import FILE_PATH</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your imported file does not reflect correctly, there is an old save file from the <a href="#save-command">autosave feature</a>. To rectify the
problem:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Close CarviciM.</p>
</li>
<li>
<p>Look for a file in the same folder with the same filename, with <code>-comments.xlsx</code> or
<code>-comments.xls</code> behind.</p>
</li>
<li>
<p>Delete the file.</p>
</li>
<li>
<p>Start CarviciM and try again.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Filepath: A text representation of the location of the file used by the computer.</p>
</li>
<li>
<p>CarviciM tries to read the file by rows:</p>
<div class="ulist">
<ul>
<li>
<p>The first row specifies the type of detail in the column. This can be seen in the table below:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The excel file must not be password-protected</p>
</li>
<li>
<p>It is preferable to only import files within this application&#8217;s folder, as other programs
outside the folder might affect CarviciM&#8217;s performance</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is an example of an excel sheet that can be imported:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 59%;">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">client name</th>
<th class="tableblock halign-left valign-top">client phone</th>
<th class="tableblock halign-left valign-top">client email</th>
<th class="tableblock halign-left valign-top">vehicle number</th>
<th class="tableblock halign-left valign-top">employee name</th>
<th class="tableblock halign-left valign-top">employee phone</th>
<th class="tableblock halign-left valign-top">employee email</th>
<th class="tableblock halign-left valign-top">status</th>
<th class="tableblock halign-left valign-top">remarks</th>
<th class="tableblock halign-left valign-top">empty column</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">John Doe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">91234567</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:jd@gmail.com">jd@gmail.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SXX1234X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">87654321</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:jim@gmail.com">jim@gmail.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Your remark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ongoing</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The columns can be interchanged, with <code>empty column</code> at the last column.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>import excel-file.xlsx</code><br>
Imports the example file excel-file.xlsx shown above. You should see:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/import-example.png" alt="import example" width="1200">
</div>
</div>
</div>
<div class="sect4">
<h5 id="switching-views-between-unreviewed-jobs-and-jobs-in-carvicim-code-switch-code"><a class="link" href="#switching-views-between-unreviewed-jobs-and-jobs-in-carvicim-code-switch-code">Switching views between unreviewed jobs and jobs in CarviciM: <code>switch</code></a></h5>
<div class="paragraph">
<p>You can use this command to switch between the list of unreviewed jobs and jobs in CarviciM.<br>
Format: <code>switch</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can see the current job list in the job list indicator.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="accept-reject"><a class="link" href="#accept-reject">Accepting and rejecting changes</a></h5>
<div class="paragraph">
<p>You can use 4 commands when reviewing changes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>accept NUMBER</code></p>
</li>
<li>
<p><code>reject NUMBER</code></p>
</li>
<li>
<p><code>acceptAll</code></p>
</li>
<li>
<p><code>rejectAll</code></p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="accepting-1-job-code-accept-code"><a class="link" href="#accepting-1-job-code-accept-code">Accepting 1 job: <code>accept</code></a></h6>
<div class="paragraph">
<p>To accept a job with job index <code>NUMBER</code> in the imported list, use this command as follows:
Format: <code>accept NUMBER</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>accept 1</code><br>
Accepts the job entry with job index number 1 and removes it from imported list.</p>
</div>
</div>
<div class="sect5">
<h6 id="acceptAll-command"><a class="link" href="#acceptAll-command">Accepting all remaining imported jobs: <code>acceptAll</code></a></h6>
<div class="paragraph">
<p>To accept all remaining jobs, use this command as follows:
Format: <code>acceptAll</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>acceptAll</code><br>
Accepts all remaining job entries and clears the imported list.</p>
</div>
</div>
<div class="sect5">
<h6 id="rejecting-1-job-code-reject-code"><a class="link" href="#rejecting-1-job-code-reject-code">Rejecting 1 job: <code>reject</code></a></h6>
<div class="paragraph">
<p>To reject a job with job index <code>NUMBER</code> in the imported list, use this command as follows:
Format: <code>reject NUMBER</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>reject 1</code><br>
Rejects job entry with job index number 1 and removes it from imported list. It is not added to CarviciM.</p>
</div>
</div>
<div class="sect5">
<h6 id="rejecting-all-remaining-imported-jobs-code-rejectall-code"><a class="link" href="#rejecting-all-remaining-imported-jobs-code-rejectall-code">Rejecting all remaining imported jobs: <code>rejectAll</code></a></h6>
<div class="paragraph">
<p>To reject all remaining jobs in the imported list, use this command as follows:
Format: <code>rejectAll</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>rejectAll</code><br>
Rejects all remaining job entries and clears the imported list.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-comments-to-your-reviews"><a class="link" href="#writing-comments-to-your-reviews">Writing comments to your reviews</a></h5>
<div class="paragraph">
<p>While accepting or rejecting changes, you can enter your comments behind the command.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can type any sentence as a comment, as long as it is separated from the last argument with a
spacebar character.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Example 1:<br></p>
<div class="paragraph">
<p><code>accept 1</code> good job`<br>
Accepts first job and attaches "good job" as a comment to the first job.</p>
</div>
</li>
<li>
<p>Example 2:<br></p>
<div class="paragraph">
<p><code>acceptAll well done</code><br>
Accepts all remaining imported jobs and attaches "well done" as a comment to all the remaining imported jobs.</p>
</div>
</li>
<li>
<p>Example 3:<br></p>
<div class="paragraph">
<p><code>reject 1 Speak to you during tomorrow&#8217;s meeting.</code><br>
Rejects first job and attaches "Speak to you during tomorrow&#8217;s meeting." as a comment to the first job.</p>
</div>
</li>
<li>
<p>Example 4:<br></p>
<div class="paragraph">
<p><code>rejectAll Please check the customer details.</code><br>
Rejects all remaining imported jobs and attaches "Please check the customer details." as a comment to all the remaining imported jobs.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="save-command"><a class="link" href="#save-command">Sharing your feedback with your employees:</a></h4>
<div class="paragraph">
<p>To send your feedback to the job list providers, look for the save file generated after importing and reviewing your jobs.
CarviciM autosaves your comments to an excel file with <code>-comments.xls</code> or <code>-comments.xlsx</code> appended,
in the same directory.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
When copying <code>-comments.xls</code> or <code>-comments.xlsx</code> files, try to keep the original copy in the folder. It helps to prevent
reimporting the same jobs from the a file with the same name twice.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="contributions-to-the-developer-guide"><a class="link" href="#contributions-to-the-developer-guide">Contributions to the Developer Guide</a></h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections I contributed to the Developer Guide. They showcase my ability to write technical documentation and the technical depth of my contributions to the project.</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="supporting-setting-of-command-word-alias-feature"><a class="link" href="#supporting-setting-of-command-word-alias-feature">Supporting setting of command word alias feature</a></h3>
<div class="sect3">
<h4 id="current-implementation"><a class="link" href="#current-implementation">Current Implementation</a></h4>
<div class="imageblock">
<div class="content">
<img src="../images/SetCommandClassDiagram.png" alt="SetCommandClassDiagram" width="400">
</div>
<div class="title">Figure 1. Class Diagram with CommandWords</div>
</div>
<div class="paragraph">
<p>The user can set a command word alias using the command <code>set</code>, specifying the old command
word and new command word. This is how <code>set</code> command handles user requests using <code>currentWord</code>
and <code>newWord</code> respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> CommandResult executeUndoableCommand() <span class="directive">throws</span> CommandException {
        requireNonNull(model);
        <span class="keyword">try</span> {
            model.getCommandWords().setCommandWord(currentWord, newWord);
        } <span class="keyword">catch</span> (CommandWordException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(e.getMessage());
        }
        <span class="keyword">if</span> (CommandWords.isDefaultCommandWord(currentWord)) {
            <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(getMessageDefaultSuccess());
        } <span class="keyword">else</span> <span class="keyword">if</span> (CommandWords.isDefaultCommandWord(newWord)) {
            <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(getMessageRemoveAliasSuccess());
        }
        <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(getMessageAliasSuccess());
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command splits into 3 cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When <code>currentWord</code> is a command word and <code>newWord</code> is an alias, <code>newWord</code> will be set as alias
for command specified by <code>currentWord</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CommandWords.isDefaultCommandWord(currentWord)</code></pre>
</div>
</div>
</li>
<li>
<p>When <code>newWord</code> is a command word and <code>currentWord</code> is an alias, <code>currentWord</code> will be removed
and the alias for command specified by <code>newWord</code> will be reset</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CommandWords.isDefaultCommandWord(newWord)</code></pre>
</div>
</div>
</li>
<li>
<p>If <code>currentWord</code> and <code>newWord</code> are both new alias, the old alias will be replaced by the new alias.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The command will fail if one of the following occurs</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>currentWord</code> and <code>newWord</code> is the same</p>
</li>
<li>
<p><code>newWord</code> overwrites another alias or command word</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">private</span> <span class="type">void</span> isCommandWordsValid(<span class="predefined-type">String</span> currentWord, <span class="predefined-type">String</span> newWord) <span class="directive">throws</span> CommandWordException {
        <span class="keyword">if</span> (currentWord.equals(newWord)) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandWordException(getMessageNoChange());
        }
        <span class="keyword">if</span> (isDefaultCommandWord(newWord)
                &amp;&amp; !commands.get(newWord).equals(currentWord)) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandWordException(getMessageOverwriteDefault(newWord));
        }
        <span class="keyword">if</span> (commands.containsValue(newWord)) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandWordException(getMessageUsed(newWord));
        }
    }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>currentWord</code> is not an existing alias or command word. This is checked by iterating through commands.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>set</code> command makes use of class <code>CommandWords</code> to manage the custom command words.
<code>SetCommand</code> keeps 2 lists of command words:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The default command words stored as a class level reference <code>COMMANDS</code></p>
</li>
<li>
<p>The command word aliases are stored as a field <code>commands</code> in the object</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both are managed by the class <code>CommandWords</code>.</p>
</div>
<div class="paragraph">
<p>CarvicimParser makes a reference to <code>CommandWords</code> to facilitate retrieval of alias command words.
However, <code>CommandWords</code> resides in <code>Model</code> (Figure 12). This is to facilitate the saving of data.</p>
</div>
<div class="paragraph">
<p>CommandWords also has a method <code>checkIntegrity()</code>, which ensures that object command words are 1 to 1 with class command words.
This allows forward compatibility when new command words are introduced, and old ones removed,
and protects against data corruption to some extent.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/SetCommandSequenceDiagram.png" alt="SetCommandSequenceDiagram" width="800">
</div>
<div class="title">Figure 2. Class Diagram with CommandWords</div>
</div>
<div class="paragraph">
<p>At runtime, CarvicimParser checks if the command word provided by the user matches any of the alias before proceeding
parsing a command, as shown in Figure 13.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-where-to-put-commandwords-for-storage"><a class="link" href="#aspect-where-to-put-commandwords-for-storage">Aspect: Where to put CommandWords for storage</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Place <code>CommandWords</code> in <code>UserPrefs</code></p>
<div class="ulist">
<ul>
<li>
<p>Pros: Single Responsibility Principle is maintained as custom command words in <code>CommandWords</code> is a user preference.
CommandWords is also Serializable, which makes it compatible with <code>JsonUserPrefsStorage</code>.</p>
</li>
<li>
<p>Cons: <code>CommandWords</code> is now coupled with <code>UserPrefs</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Place <code>CommandWords</code> into a separate Storage class</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Reduced coupling.</p>
</li>
<li>
<p>Cons: More files will be created in the application directory, making it more cluttered and cumbersome to backup.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-access-to-commandwords"><a class="link" href="#aspect-access-to-commandwords">Aspect: Access to CommandWords</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Create getters and setters and provide a copy of <code>CommandWords</code> when more detail is needed.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to enforce rules on the changing of the alias in <code>CommandWords</code>.</p>
</li>
<li>
<p>Cons: Need to modify getters and setters to change the implementation of <code>CommandWords</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Create <code>CommandWords</code> like an augmented <code>HashMap</code></p>
<div class="ulist">
<ul>
<li>
<p>Pros: Minimal new <a href="#api">APIs</a> are required, and flexibility is given to classes accessing <code>CommandWords</code>.</p>
</li>
<li>
<p>Cons: Difficult to enforce rules, breaking the rules of mapped words can lead to bugs.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-storing-the-list-of-default-command-words"><a class="link" href="#aspect-storing-the-list-of-default-command-words">Aspect: Storing the list of default command words</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Store the default list in <code>CommandWords</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easier to maintain the Open-Closed Principle, also follows the Single Responsibility Principle.</p>
</li>
<li>
<p>Cons: Command words have to be explicitly declared under class reference to support alias</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Store the default list in <code>Command</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: <code>Command</code> is the super class of all commands, a method to enforce declaration of the command word
can be done easily.</p>
</li>
<li>
<p>Cons: <code>Command</code> is an abstract class, it is not appropriate to reference class variables.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="import-feature"><a class="link" href="#import-feature">Import feature</a></h3>
<div class="sect3">
<h4 id="current-implementation-2"><a class="link" href="#current-implementation-2">Current Implementation</a></h4>
<div class="imageblock">
<div class="content">
<img src="../images/SessionComponentClassDiagram.png" alt="SessionComponentClassDiagram" width="800">
</div>
<div class="title">Figure 3. Class Diagram of <code>session</code> component</div>
</div>
<div class="paragraph">
<p><code>ImportSession</code> resides in the <code>Session</code> component in the <code>Storage</code> component as shown above. The
<code>Session</code> component is responsible for processing excel files, as well as keeping the state of the excel
files during runtime, in the form of <code>SessionData</code>.</p>
</div>
<div class="paragraph">
<p><code>ImportSession</code> uses a Singleton design pattern. It is responsible for initializing and closing the session.
<code>ImportSession</code> has 4 methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>static getInstance()</code>: Used to retrieve the single instance of <code>ImportSession</code>.</p>
</li>
<li>
<p><code>setData(sessionData)</code>: Used to set <code>sessionData</code> for <code>ImportSession</code>.</p>
</li>
<li>
<p><code>initialize(fileName)</code>: Initializes <code>sessionData</code> with and excel file located at <code>fileName</code>.</p>
</li>
<li>
<p><code>closeSession()</code>: Writes the comments as a save file to same directory of import file,
with a timestamp added to the back of the filename.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>ImportSession</code> is designed to be stateless on its own, with all data stored in <code>SessionData</code>. This helps to
support <code>UndoableCommand</code>.
The flow of using <code>ImportSession</code> is as follows:</p>
</div>
<div class="sect4">
<h5 id="loading-a-file-into-code-importsession-code"><a class="link" href="#loading-a-file-into-code-importsession-code">Loading a file into <code>ImportSession</code></a></h5>
<div class="ulist">
<ul>
<li>
<p>Figure 15 below shows the process of initializing ImportSession. On the <code>import</code> command,
<code>getInstance</code> is used to retrieve the <code>importSession</code> instance, before it calls
<code>initialize(fileName)</code>. A new <code>SheetParser</code> is created to populate <code>sessionData</code> with excel sheet data
as shown in Figure 11, which comes as:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>SheetWithHeaderField</code>: Augmented <code>Sheet</code> that provides API to indicate approval status and
write comments.</p>
</li>
<li>
<p><code>JobEntry</code>: Augmented <code>Job</code> stores the sheet number and row number for writing into the excel file.
<code>JobEntry</code> also contains the <code>Job</code> data which will be imported upon approval.</p>
<div class="imageblock">
<div class="content">
<img src="../images/sessionInitializationSequenceDiagram.png" alt="sessionInitializationSequenceDiagram" width="800">
</div>
<div class="title">Figure 4. Sequence Diagram of <code>ImportSession</code> initialization</div>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="reviewing-job-entries"><a class="link" href="#reviewing-job-entries">Reviewing job entries</a></h5>
<div class="ulist">
<ul>
<li>
<p>Figure 16 below shows the process of reviewing job entries in an import session. On the <code>review</code>
command, <code>sessionData</code> updates the relevant <code>jobEntry</code> and retrieves the sheet and row number,
which is used to update <code>sheetWithHeaderFields</code>. Upon reviewing a job, CarviciM will add the job and
any employees not present in the application.</p>
<div class="imageblock">
<div class="content">
<img src="../images/sessionReviewSequenceDiagram.png" alt="sessionReviewSequenceDiagram" width="800">
</div>
<div class="title">Figure 5. Sequence Digram of <code>ImportSession</code> during the reviewing of a job</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="saving-feedback-from-an-code-importsession-code"><a class="link" href="#saving-feedback-from-an-code-importsession-code">Saving feedback from an <code>ImportSession</code></a></h5>
<div class="paragraph">
<p><code>SessionData</code> autosaves the comments to an excel file with the same file name and <code>-comments.xls</code> or <code>-comments.xlsx</code> appended,
in the same directory.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-supporting-undoablecommand"><a class="link" href="#aspect-supporting-undoablecommand">Aspect: Supporting UndoableCommand</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Save a copy of the previous instance of <code>sessionData</code> using <code>createCopy()</code> whenever an
<code>UndoableCommand</code> is executed, then load the previous instance on undo. Data in the copy will be written to
a <code>.temp</code> file, with a timestamp prepended to its name to make it unique. Most of the <code>.temp</code> files will be
wiped on application exit.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: <code>sessionData</code> stores data for <code>importSession</code>, making it appropriate to be used as data in <code>undo</code>
and <code>redo</code>. Modification is only limited to <code>UndoableCommand</code>. Code for <code>undo</code> can be reused for any commands that
affect <code>sessionData</code> in the future, respecting Open Closed Principle.</p>
</li>
<li>
<p>Cons: IOException still has to be handled in <code>sessionData</code> on undo. <code>undo</code> and <code>redo</code> can fail now because of IOException and they have to be modified. <code>.temp</code> files
can also cause home folder to bloat in size during runtime after many commands are entered.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> <code>importSession</code> provides API to <code>undo</code> and <code>redo</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: <code>ImportSession</code> can effectively handle <code>undo</code> and <code>redo</code> on its own without additional dependencies.
Open Closed Principle is respected, there is no need to modify <code>UndoableCommand</code>.</p>
</li>
<li>
<p>Cons: Difficult to coordinate with <code>UndoRedoStack</code> as jobs and employees in <code>model</code> are also affected. IOExceptions
thrown also need to be handled, requiring <code>UndoableCommand</code> to be modified for handling of Exceptions.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-supporting-mass-add-method-addjobsandnewemployees"><a class="link" href="#aspect-supporting-mass-add-method-addjobsandnewemployees">Aspect: Supporting mass add method addJobsAndNewEmployees</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Add the methods to <code>Model</code></p>
<div class="ulist">
<ul>
<li>
<p>Pros: Cohesion is maximized, these methods can also be reused by other classes.</p>
</li>
<li>
<p>Cons: Open Closed Principle is violated and adding these methods may result in confusion on the
behavior of <code>Model</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Add the methods to an abstract <code>ReviewCommand</code> and inherit the methods for <code>AcceptAll</code>/<code>RejectAll</code> commands.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: The behavior of these methods can be tailored specifically to <code>AcceptAll</code>/<code>RejectAll</code> commands.</p>
</li>
<li>
<p>Cons: Modifying the implementation of <code>Model</code> may affect the behavior of <code>ReviewCommand</code> without knowing, leading to
potential regressions.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-reading-of-first-row-headers-from-excel-files"><a class="link" href="#aspect-reading-of-first-row-headers-from-excel-files">Aspect: Reading of first row headers from excel files</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Allow compulsory and optional fields, with variable number of columns and variable order.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Flexible on format of imported excel files. Also allows future expansion of single column fields.</p>
</li>
<li>
<p>Cons: User may not appreciate the flexibility if he or she can enforce the format of the excel files received.
Flexibility provided is not enough for unknown headers.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Fix the format of the headers.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Confusion can be reduced, importing errors can also be minimized.</p>
</li>
<li>
<p>Cons: Users cannot further customize job entries on import with optional fields, optional field data will be lost.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-reading-of-job-entries-from-excel-files"><a class="link" href="#aspect-reading-of-job-entries-from-excel-files">Aspect: Reading of job entries from excel files</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Find the first complete job entry. Subsequently, whenever the next job entry is read, if there
are empty fields, take those fields from the previous job entry. Missing fields will be added to remarks and comments.
Repeat until there are no job entries in the file.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Allows excel sheet providers to save time on filling reused data between adjacent job entries.</p>
</li>
<li>
<p>Cons: Unintentional blanks may result in job entries with wrong data being imported, requiring the user to look
through the remarks of the imported job entries.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Only import complete job entries</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Incomplete job entries will not be errorneously imported into CarviciM.</p>
</li>
<li>
<p>Cons: User will not be able to review incomplete job entries in the CarviciM as only complete jobs are imported.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-uniqueness-of-job-entries"><a class="link" href="#aspect-uniqueness-of-job-entries">Aspect: Uniqueness of job entries</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Use <code>jobNumber</code> in the application on import. To prevent reimporting the same excel
file twice, a file with the same name and a <code>-comments.xls</code> or <code>-comments.xlsx</code> appended, and every subsequent import reads from this file if</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Job entry number is controlled by CarviciM and can stay unique. Job entries from excel files can
also stay unique if there are no duplicates within or across excel files.</p>
</li>
<li>
<p>Cons: User might import the same file if the <code>-comments.xls</code> or <code>-comments.xlsx gets misplaced, and become confused.
The `jobNumber</code> associated with the same imported job might also change on every different import.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Use a hash function to decide the <code>jobNumber</code> of a job. When there is a collision, add a suffix to make the <code>jobNumber</code> unique.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: <code>jobNumber</code> stays the same on import, independent of when it is imported.</p>
</li>
<li>
<p>Cons: <code>JobNumber</code> has to be modified to support this implementation.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-04-15 16:05:36 UTC
</div>
</div>
</body>
</html>