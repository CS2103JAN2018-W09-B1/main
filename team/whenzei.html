<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Ow Zhen Wei - Project Portfolio</title>
<link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>Ow Zhen Wei - Project Portfolio</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="project-carvicim"><a class="link" href="#project-carvicim">PROJECT: CarviciM</a></h2>
<div class="sectionbody">
<hr>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="link" href="#overview">Overview</a></h2>
<div class="sectionbody">
<div class="imageblock" style="text-align: left">
<div class="content">
<img src="../images/CarviciM_logo.PNG" alt="CarviciM logo" width="150">
</div>
</div>
<div class="paragraph">
<p>CarviciM is an efficient and systematic application for car servicing managers to manage their servicing jobs and employee assignment. It is a Command Line Interface (CLI) application which is optimized for users who are adpet at using the keyboard.
CarviciM is built on the <a href="https://github.com/nus-cs2103-AY1718S2/addressbook-level4">AddressBook - Level 4</a> project (used for teaching Software Engineering principles). It is written in Java, and has about 10 kLoC.</p>
</div>
<div class="paragraph">
<p>This portfolio summarizes my contributions for the development of CarviciM. It showcases the software engineering knowledge that i have learned and applied throughout the project.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary-of-contributions"><a class="link" href="#summary-of-contributions">Summary of contributions</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Major enhancement</strong>: added <strong>the ability to manage jobs</strong></p>
<div class="ulist">
<ul>
<li>
<p>What it does: allows the user to add new job entries with employees assignment for each job, close an ongoing job entry in the application, and add remark to ongoing jobs.</p>
</li>
<li>
<p>Justification: Car servicing managers need to manage huge numbers of job entries, and keep track of the employees that are assigned to them. These set of features give them a systematic and convenient way to manage the servicing jobs.</p>
</li>
<li>
<p>Highlights: This enhancement requires the morphing of the <em>AddressBook - Level 4</em> project and require substantial changes to the codebase. As the added features interact with the 'management of contacts' feature from the addressbook application, changes were to be made to the existing commands so that the newly added commands would work properly. Most changes were made in the Model component.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Minor enhancement</strong>: added the theme setting feature which users can select from the list of themes.</p>
<div class="ulist">
<ul>
<li>
<p>Justification: The default application only supports one theme and users would prefer to have more control over how the application looks. They may prefer to use different themes under certain circumstances (e.g. A brighter look would be prefered when working in a different environment, as it is more pleasing to the eyes.)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Code contributed</strong>: [<a href="https://github.com/CS2103JAN2018-W09-B1/main/blob/master/collated/functional/whenzei.md">Functional code</a>] [<a href="https://github.com/CS2103JAN2018-W09-B1/main/blob/master/collated/test/whenzei.md">Test Code</a>]</p>
</li>
<li>
<p><strong>Other contributions</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Project management:</p>
<div class="ulist">
<ul>
<li>
<p>Managed releases <code>v1.3</code> - <code>v1.5rc</code> (3 releases) on Github.</p>
</li>
<li>
<p>Managed milestones <code>v1.1</code> - <code>v1.3</code> (3 milestones) on Github.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enhancements to existing features:</p>
<div class="ulist">
<ul>
<li>
<p>Added JobDisplayPanel to support the displaying of job details (Pull request <a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/94">#94</a>, <a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/152">#152</a>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Documentation:</p>
<div class="ulist">
<ul>
<li>
<p>Improved on the user-friendliness of the User Guide by adding screenshots and restructuring the sections to have a better flow. (Pull request <a href="https://github.com/CS2103JAN2018-W09-B1/main/pull/179">#179</a>)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-user-guide"><a class="link" href="#contributions-to-the-user-guide">Contributions to the User Guide</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections that I have contributed to the User Guide. They showcase my ability to write documentation targeting end-users.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="adding-a-job-entry-code-addj-code"><a class="link" href="#adding-a-job-entry-code-addj-code">Adding a job entry: <code>addj</code></a></h3>
<div class="paragraph">
<p>To add a new job entry and assign employees to the job, use this command as follows:<br>
Format: <code>addj n/NAME p/PHONE_NUMBER e/EMAIL v/VEHICLE_NUMBER w/ASSIGNED_EMPLOYEE_INDEX+</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>addj</code> command adds a job with the given fields, and assign employees based on specified <code>ASSIGNED_EMPLOYEE_INDEX</code>.</p>
</li>
<li>
<p>The index refers to the index number shown in the most recent employee listing.</p>
</li>
<li>
<p>The index <strong>must be a positive integer</strong> 1, 2, 3, &#8230;&#8203;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>addj n/John Doe p/98765432 e/johnd@example.com v/bhj123 w/3</code><br>
You will see "New job added: &#8230;&#8203; " in the result display as shown in the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/addj-command-example.PNG" alt="addj command example" width="500">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.2.1 : Result display indicating that a job has been added</em></p>
</div>
<div class="paragraph">
<p>The job list panel will be updated to display the newly added job as seen in the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/addj-job-list-panel-before.PNG" alt="addj job list panel before" width="300">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.2.2 : Job list panel before addition of job entry</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/addj-job-list-panel-after.PNG" alt="addj job list panel after" width="300">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.2.3 : Job list panel after addition of job entry</em></p>
</div>
</div>
<div class="sect2">
<h3 id="closing-a-job-entry-code-closej-code"><a class="link" href="#closing-a-job-entry-code-closej-code">Closing a job entry: <code>closej</code></a></h3>
<div class="paragraph">
<p>To indicate that a job is completed in CarviciM, use this command as follows:<br>
Format: <code>closej j/JOB_NUMBER</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>closej j/2</code><br>
This command closes the ongoing job of number 2 in CarviciM.<br>
You will see "Closed Job&#8230;&#8203;" in the result display as shown in the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/closej-command-example.PNG" alt="closej command example" width="500">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.3.1 : Result display indicating that a job has been closed</em></p>
</div>
<div class="paragraph">
<p>You will also see the job of number 2 have its status shown as "closed" in the job list panel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/closej-job-list-panel-before.PNG" alt="closej job list panel before" width="300">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.3.2 : Job list panel before job is closed</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/closej-job-list-panel-after.PNG" alt="closej job list panel after" width="300">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.3.3 : Job list panel after job is closed</em></p>
</div>
</div>
<div class="sect2">
<h3 id="adding-remark-to-a-job-code-remark-code"><a class="link" href="#adding-remark-to-a-job-code-remark-code">Adding remark to a job: <code>remark</code></a></h3>
<div class="paragraph">
<p>To add remark or special note to an ongoing job entry, use this command as follows:<br>
Format: <code>remark j/JOB_NUMBER r/YOUR_REMARK</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>remark j/2 r/An urgent work that should be completed asap</code><br>
This command will add the remark "An urgent work that should be completed asap" to a job entry of a job number "2".<br>
You will see the message "Remark added to job number &#8230;&#8203;" reflected in the result display (shown in the image below).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/remark-command-example.PNG" alt="remark command example" width="500">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.4.1 : Result display showing feedback for remark added</em></p>
</div>
</div>
<div class="sect2">
<h3 id="setting-a-theme-code-theme-code"><a class="link" href="#setting-a-theme-code-theme-code">Setting a theme : <code>theme</code></a></h3>
<div class="paragraph">
<p>To set the theme of the application for a change of working environment, use this command as follows:<br>
Format: <code>theme INDEX</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Sets the theme based on the specified 'INDEX'</p>
</li>
<li>
<p>The index refers to the index number shown in the most recent listing</p>
</li>
<li>
<p>The index <strong>must be a positive integer</strong> 1, 2, 3,&#8230;&#8203;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You will be able to select from these 3 themes:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/mauve-theme.PNG" alt="mauve theme" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.20.1 : Mauve Theme</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/dark-theme.PNG" alt="dark theme" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.20.2 : Dark Theme</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/light-theme.PNG" alt="light theme" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 5.20.3 : Light Theme</em></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p><code>theme</code><br>
You will see the list of valid themes to choose from in the result display.<br></p>
</div>
<div class="paragraph">
<p><code>theme 1</code><br>
You will see the theme of the application set as the selected one.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-developer-guide"><a class="link" href="#contributions-to-the-developer-guide">Contributions to the Developer Guide</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections that I have contributed to the Developer Guide. They showcase my ability to write technical documentation and the technical depth of my contributions to the project.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="add-job-feature"><a class="link" href="#add-job-feature">Add job feature</a></h3>
<div class="sect3">
<h4 id="current-implementation"><a class="link" href="#current-implementation">Current Implementation</a></h4>
<div class="paragraph">
<p>To implement the job management feature, new classes are added to the <code>Model</code> component. <code>Job</code> is part of the <code>Model</code> component which is made up of <code>Person</code>, <code>JobNumber</code>, <code>VehicleNumber</code>, <code>Status</code>, <code>Date</code>, <code>UniqueEmployeeList</code> and <code>RemarkList</code> as shown below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ModelClassDiagram.png" alt="ModelClassDiagram" width="800">
</div>
<div class="title">Figure 1. Class Diagram of Model component</div>
</div>
<div class="paragraph">
<p><code>Person</code> represents the client of a job. <code>JobNumber</code> represents the number of a job and is responsible for generating a running number for each job. <code>Status</code> represents the status of a job which holds value of either <code>ongoing</code> or <code>closed</code> that is used for categorizing jobs. <code>Date</code> represents the date of creation for the job. <code>RemarkList</code> holds all <code>Remark</code> belonging to the job. <code>UniqueEmployeeList</code> of the job represents the employees assigned.</p>
</div>
<div class="paragraph">
<p>New classes has also been added in the Storage component, <code>XmlAdaptedJob</code> and <code>XmlAdaptedRemark</code>, to support the saving of job entries into the data file.</p>
</div>
<div class="paragraph">
<p>The job adding mechanism is facilitated by a <code>AddJobCommand</code> which is an <code>UndoableCommand</code>. <code>AddJobCommandParser</code> is responsible for parsing the input arguments. It utilizes <code>ParserUtil</code> for the validation of <code>NAME</code>, <code>PHONE</code>, <code>EMAIL</code>, <code>VEHICLE_NUMBER</code> and <code>ASSIGNED_EMPLOYEE_INDEX</code> and creates <code>AddJobCommand</code> object which prepares the <code>Job</code> object.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the parameters are invalid, <code>addj</code> command will return an invalid message, which shows the usage information to the user.
(e.g. <code>addj n/John Doe p/9999999 e/john@example.com v/SHG123 w/-1</code>).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p><code>AddJobCommandParser</code> code snippet to validate the parameters, <code>NAME</code>, <code>PHONE</code>, <code>EMAIL</code>, <code>VEHICLE_NUMBER</code>, <code>ASSIGNED_EMPLOYEE_INDEX+</code>, which returns <code>AddJobCommand</code> object if valid, and invalid message otherwise:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> AddJobCommand parse(<span class="predefined-type">String</span> args) <span class="directive">throws</span> <span class="exception">ParseException</span> {
        ArgumentMultimap argMultimap =
                ArgumentTokenizer.tokenize(args, PREFIX_NAME, PREFIX_PHONE,
                        PREFIX_EMAIL, PREFIX_VEHICLE_NUMBER, PREFIX_ASSIGNED_EMPLOYEE);

        <span class="keyword">if</span> (!arePrefixesPresent(argMultimap, PREFIX_NAME, PREFIX_PHONE,
                PREFIX_EMAIL, PREFIX_VEHICLE_NUMBER, PREFIX_ASSIGNED_EMPLOYEE)) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(<span class="predefined-type">String</span>.format(MESSAGE_INVALID_COMMAND_FORMAT, AddJobCommand.MESSAGE_USAGE));
        }

        <span class="keyword">try</span> {
            <span class="predefined-type">Name</span> name = ParserUtil.parseName(argMultimap.getValue(PREFIX_NAME)).get();
            Phone phone = ParserUtil.parsePhone(argMultimap.getValue(PREFIX_PHONE)).get();
            Email email = ParserUtil.parseEmail(argMultimap.getValue(PREFIX_EMAIL)).get();
            VehicleNumber vehicleNumber =
                    ParserUtil.parseVehicleNumber(argMultimap.getValue(PREFIX_VEHICLE_NUMBER)).get();
            <span class="predefined-type">ArrayList</span>&lt;Index&gt; assignedEmployeeIndices =
                    ParserUtil.parseIndices(argMultimap.getAllValues(PREFIX_ASSIGNED_EMPLOYEE));

            Person client = <span class="keyword">new</span> Person(name, phone, email);
            <span class="keyword">return</span> <span class="keyword">new</span> AddJobCommand(client, vehicleNumber, assignedEmployeeIndices);

        } <span class="keyword">catch</span> (IllegalValueException ive) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(<span class="predefined-type">String</span>.format(MESSAGE_INVALID_COMMAND_FORMAT, AddJobCommand.MESSAGE_USAGE));
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>preprocessUndoableCommand</code> method code snippet in <code>AddJobCommand</code> that checks if assigned employee exists for the indices given. It creates <code>Job</code> object only if valid, and throws an invalid message otherwise:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">protected</span> <span class="type">void</span> preprocessUndoableCommand() <span class="directive">throws</span> CommandException {
        <span class="predefined-type">List</span>&lt;Employee&gt; lastShownList = model.getFilteredPersonList();

        <span class="comment">//Check for valid employee indices</span>
        <span class="keyword">for</span> (Index targetIndex : targetIndices) {
            <span class="keyword">if</span> (targetIndex.getZeroBased() &gt;= lastShownList.size()) {
                <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(Messages.MESSAGE_INVALID_EMPLOYEE_DISPLAYED_INDEX);
            }
        }

        <span class="keyword">try</span> {
            <span class="keyword">for</span> (Index targetIndex : targetIndices) {
                assignedEmployees.add(lastShownList.get(targetIndex.getZeroBased()));
            }
            toAdd = <span class="keyword">new</span> Job(client, vehicleNumber, <span class="keyword">new</span> JobNumber(), <span class="keyword">new</span> <span class="predefined-type">Date</span>(), assignedEmployees,
                    <span class="keyword">new</span> Status(Status.STATUS_ONGOING), <span class="keyword">new</span> RemarkList());
        } <span class="keyword">catch</span> (DuplicateEmployeeException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(<span class="string"><span class="delimiter">&quot;</span><span class="content">Duplicate employee index</span><span class="delimiter">&quot;</span></span>);
        }

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the <code>AddJobCommand</code> determines if a <code>Job</code> object can be created and added into the list of jobs if it is valid:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/AddJobCommand_preprocess_SeqDiag.png" alt="AddJobCommand preprocess SeqDiag" width="1000">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/AddJobCommand_execute_SeqDiag.png" alt="AddJobCommand execute SeqDiag" width="500">
</div>
</div>
<div class="paragraph">
<p>The successful execution of <code>AddJobCommand</code> adds the <code>Job</code> to CarviciM.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-modelling-jobs-in-carvicim"><a class="link" href="#aspect-modelling-jobs-in-carvicim">Aspect: Modelling jobs in CarviciM</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Adding a list in <code>Carvicim</code> class to keep track of all jobs, and adding an attribute for keeping a list of assigned employees in <code>Job</code> class.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Finding assigned employees of a job, requires only going through the assigned employee list of the job. Removal of a job is done easily by removing it from the list of jobs.</p>
</li>
<li>
<p>Cons: Additional list to maintain, other than the list of employees. Changes to an employee needs to be updated for all jobs that contains the respective employee.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Add a new attribute in <code>Employee</code> class to keep a list of jobs.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Only need to maintain a single list of employees. Finding jobs that are assigned to an <code>Employee</code> object only requires going through the job list.</p>
</li>
<li>
<p>Cons: Finding all employees belonging to a job, requires going through the job list of all employees. The removal of a job, requires going through all employees, as a job can be assigned to multiple employees.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-checking-if-given-employee-indices-point-to-valid-employees-in-carvicim"><a class="link" href="#aspect-checking-if-given-employee-indices-point-to-valid-employees-in-carvicim">Aspect: Checking if given employee indices point to valid employees in CarviciM</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Perform check in the <code>preprocessUndoableCommand</code> method of <code>AddJobCommand</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Does not introduce more coupling.</p>
</li>
<li>
<p>Cons: <code>AddJobCommand</code> will need to store more attributes, as a <code>Job</code> object is only created when <code>preprocessUndoableCommand</code> method is executed successfully.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Allow <code>ParserUtil</code> to hold employee list.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: <code>AddJobCommandParser</code> determines if the employee indices point to valid employees, and creates the <code>Job</code> object.</p>
</li>
<li>
<p>Cons: Allowing <code>ParserUtil</code> to hold the list of employees introduce more coupling among the classes.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-ensuring-job-number-generation-is-consistent"><a class="link" href="#aspect-ensuring-job-number-generation-is-consistent">Aspect: Ensuring job number generation is consistent</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Store the next job number as a user preference.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement and initialization of job number is faster.</p>
</li>
<li>
<p>Cons: Deletion of the user preference file will cause the job number to reset.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Going through all jobs at initialization and finding the largest job number.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Does not need to depend on data stored in other files to initialize job number.</p>
</li>
<li>
<p>Cons: May be very slow when the number of jobs in the application is large.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="close-job-feature"><a class="link" href="#close-job-feature">Close job feature</a></h3>
<div class="sect3">
<h4 id="current-implementation-2"><a class="link" href="#current-implementation-2">Current Implementation</a></h4>
<div class="paragraph">
<p>The close job mechanisim is facilitated by a <code>CloseJobCommand</code>. <code>CloseJobCommandParser</code> is responsible for parsing the input arguments. It utilizes <code>ParserUtil</code> for the validation of <code>JOB_NUMBER</code> input, and creates the <code>CloseJobCommand</code> object which closes the job. A job that has been closed will have its status changed from "ongoing" to "closed".</p>
</div>
<div class="paragraph">
<p>Since <code>CloseJobCommand</code> is an undoable command, it overrides the <code>preprocessUndoableCommand</code> method of <code>UndoableCommand</code>, to check if the specified job can be closed.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the provided <code>JOB_NUMBER</code> belongs to a closed job or does not match any job in the job list, <code>CloseJobCommand</code> will return an invalid message. <code>CloseJobCommand</code> creates a copy of the job if it is found, and sets the status of the duplicate job to be "closed". This is to support the undo feature.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p><code>preprocessUndoableCommand</code> method code snippet in <code>CloseJobCommand</code>, which checks for the respective job for closing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">protected</span> <span class="type">void</span> preprocessUndoableCommand() <span class="directive">throws</span> CommandException {
        <span class="predefined-type">List</span>&lt;Job&gt; lastShownJobList = model.getFilteredJobList();
        <span class="predefined-type">Iterator</span>&lt;Job&gt; jobIterator = lastShownJobList.iterator();

        <span class="keyword">while</span> (jobIterator.hasNext()) {
            Job currJob = jobIterator.next();
            <span class="keyword">if</span> (currJob.getJobNumber().equals(<span class="local-variable">this</span>.targetJobNumber)
                    &amp;&amp; (currJob.getStatus().value).equals(Status.STATUS_ONGOING)) {
                target = currJob;
                updatedJob = createUpdatedJob(currJob);
                <span class="keyword">break</span>;
            }
        }

        <span class="keyword">if</span> (target == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(Messages.MESSAGE_JOB_NOT_FOUND);
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>'createUpdatedJob` method code snippet in <code>CloseJobCommand</code>, which creates a copy of the respective job with the status set as "closed":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="directive">static</span> Job createUpdatedJob(Job jobToEdit) {
        <span class="keyword">assert</span> jobToEdit != <span class="predefined-constant">null</span>;

        <span class="keyword">return</span> <span class="keyword">new</span> Job(jobToEdit.getClient(), jobToEdit.getVehicleNumber(), jobToEdit.getJobNumber(),
                jobToEdit.getDate(), jobToEdit.getAssignedEmployees(),
                <span class="keyword">new</span> Status(Status.STATUS_CLOSED), jobToEdit.getRemarkList());
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>executeUndoableCommand</code> method code snippet in <code>CloseJobCommand</code>, which updates the job list with the job copy created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> CommandResult executeUndoableCommand() {
        requireNonNull(target);
        requireNonNull(updatedJob);
        <span class="keyword">try</span> {
            model.closeJob(target, updatedJob);
        } <span class="keyword">catch</span> (JobNotFoundException jnfe) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">AssertionError</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">The target job cannot be missing</span><span class="delimiter">&quot;</span></span>);
        }

        <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_CLOSE_JOB_SUCCESS, updatedJob));
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sequence diagram show how the <code>preprocessUndoableCommand</code> method in the <code>CloseJobCommand</code> works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/CloseJobCommand_preprocess_SeqDiag.png" alt="CloseJobCommand preprocess SeqDiag" width="700">
</div>
</div>
<div class="paragraph">
<p>The following diagram shows how the <code>executeUndoableCommand</code> method in the <code>CloseJobCommand</code> works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/CloseJobCommand_execute_SeqDiag.png" alt="CloseJobCommand execute SeqDiag" width="400">
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-where-to-hold-the-closed-jobs"><a class="link" href="#aspect-where-to-hold-the-closed-jobs">Aspect: Where to hold the closed jobs</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Closed jobs and ongoing jobs are stored in the same list</p>
<div class="ulist">
<ul>
<li>
<p>Pros: No need to add and maintain additional list for closed jobs.</p>
</li>
<li>
<p>Cons: Requires iterating through all jobs to search for a particular job. Requires the usage of <code>Predicates</code> to filter out "ongoing" and "closed" jobs for displaying to user.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Add an additional list for closed jobs in the <code>ModelManager</code></p>
<div class="ulist">
<ul>
<li>
<p>Pros: Jobs are stored in dedicated lists of either "ongoing" or "closed", and searching for jobs of a specific status only requires calling one list.</p>
</li>
<li>
<p>Cons: More attributes to manage, and may cause duplicate or missing jobs if it is not managed properly.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="job-remark-feature"><a class="link" href="#job-remark-feature">Job remark feature</a></h3>
<div class="sect3">
<h4 id="current-implementation-3"><a class="link" href="#current-implementation-3">Current Implementation</a></h4>
<div class="paragraph">
<p>The remark feature is facilitated by <code>RemarkCommand</code> which is an <code>UndoableCommand</code>. <code>RemarkCommandParser</code> is responsible for parsing the input arguments. It utilizes <code>ParserUtil</code> for the validation of <code>JOB_NUMBER</code> and <code>REMARK</code> input, and creates the <code>RemarkCommand</code> object.</p>
</div>
<div class="paragraph">
<p>Similar to the <code>CloseJobCommand</code>, the <code>RemarkCommand</code> is also an undoable command which overrides the <code>preprocessUndoableCommand</code> method of <code>UndoableCommand</code>. It checks if the specified job can have a remark added.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the paramters are invalid, <code>remark</code> command will return an invalid message, which shows the usage information to the user.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p><code>RemarkCommandParser</code> code snippet to validate the parameters, <code>JOB_NUMBER</code> and <code>REMARK</code>, which returns <code>RemarkCommand</code> object if valid, and invalid message otherwise:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> RemarkCommand parse(<span class="predefined-type">String</span> args) <span class="directive">throws</span> <span class="exception">ParseException</span> {
        ArgumentMultimap argMultimap =
                ArgumentTokenizer.tokenize(args, PREFIX_JOB_NUMBER, PREFIX_REMARK);

        <span class="keyword">if</span> (!arePrefixesPresent(argMultimap, PREFIX_JOB_NUMBER, PREFIX_REMARK)
                || !argMultimap.getPreamble().isEmpty()) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(<span class="predefined-type">String</span>.format(MESSAGE_INVALID_COMMAND_FORMAT, RemarkCommand.MESSAGE_USAGE));
        }

        <span class="keyword">try</span> {
            Remark remark = ParserUtil.parseRemark(argMultimap.getValue(PREFIX_REMARK)).get();
            JobNumber jobNumber = ParserUtil.parseJobNumber(argMultimap.getValue(PREFIX_JOB_NUMBER)).get();

            <span class="keyword">return</span> <span class="keyword">new</span> RemarkCommand(remark, jobNumber);
        } <span class="keyword">catch</span> (IllegalValueException ive) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(ive.getMessage(), ive);
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>preprocessUndoableCommand</code> method code snippet in <code>RemarkCommand</code>, which checks if the job exists and if it has a valid job status:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">protected</span> <span class="type">void</span> preprocessUndoableCommand() <span class="directive">throws</span> CommandException {
        <span class="predefined-type">List</span>&lt;Job&gt; lastShownJobList = model.getFilteredJobList();
        <span class="predefined-type">Iterator</span>&lt;Job&gt; jobIterator = lastShownJobList.iterator();

        <span class="keyword">while</span> (jobIterator.hasNext()) {
            Job currentJob = jobIterator.next();
            <span class="keyword">if</span> (currentJob.getJobNumber().equals(jobNumber)
                    &amp;&amp; (currentJob.getStatus().value).equals(Status.STATUS_ONGOING)) {
                target = currentJob;
                updatedJob = createUpdatedJob(target, remark);
                <span class="keyword">break</span>;
            }
        }

        <span class="keyword">if</span> (target == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(Messages.MESSAGE_JOB_NOT_FOUND);
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>createUpdatedJob</code> method code snippet in <code>CloseJobCommand</code>, which creates a copy of the respective job with new remark added into its list of remarks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="directive">static</span> Job createUpdatedJob(Job jobToEdit, Remark remark) {
        <span class="keyword">assert</span> jobToEdit != <span class="predefined-constant">null</span>;
        RemarkList remarks = <span class="keyword">new</span> RemarkList(jobToEdit.getRemarkList().getRemarks());
        remarks.add(remark);

        <span class="keyword">return</span> <span class="keyword">new</span> Job(jobToEdit.getClient(), jobToEdit.getVehicleNumber(), jobToEdit.getJobNumber(),
                jobToEdit.getDate(), jobToEdit.getAssignedEmployees(), jobToEdit.getStatus(), remarks);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>executeUndoableCommand</code> method code snippet in <code>RemarkCommand</code>, which updates the job list with the job copy created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> CommandResult executeUndoableCommand() {
        requireNonNull(target);
        requireNonNull(updatedJob);
        <span class="keyword">try</span> {
            model.addRemark(target, updatedJob);
        } <span class="keyword">catch</span> (JobNotFoundException jnfe) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">AssertionError</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">The target job cannot be missing</span><span class="delimiter">&quot;</span></span>);
        }
        <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_REMARK_SUCCESS, remark));
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the <code>preprocessUndoableCommand</code> method in <code>RemarkCommand</code> works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/RemarkCommand_preprocess_SeqDiag.png" alt="RemarkCommand preprocess SeqDiag" width="700">
</div>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the <code>executeUndoableCommand</code> method in <code>RemarkCommand</code> works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/RemarkCommand_execute_SeqDiag.png" alt="RemarkCommand execute SeqDiag" width="400">
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-3"><a class="link" href="#design-considerations-3">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-checking-if-given-code-job_number-code-input-points-to-a-valid-job-in-carvicim"><a class="link" href="#aspect-checking-if-given-code-job_number-code-input-points-to-a-valid-job-in-carvicim">Aspect: Checking if given <code>JOB_NUMBER</code> input points to a valid job in CarviciM</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Perform check in the <code>preprocessUndoableCommand</code> method in <code>RemarkCommand</code>, by going through the list of jobs.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Does not introduce more coupling.</p>
</li>
<li>
<p>Cons: May take some time if job list has many entries.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="theme-setting-feature"><a class="link" href="#theme-setting-feature">Theme setting feature</a></h3>
<div class="sect3">
<h4 id="current-implementation-4"><a class="link" href="#current-implementation-4">Current Implementation</a></h4>
<div class="paragraph">
<p>The theme setting mechanism is facilitated by a <code>ThemeCommand</code>. <code>ThemeCommandParser</code> is responsible for parsing the input arguments. It utilizes <code>ParserUtil</code> for the validation of <code>INDEX</code> input of <code>1</code> to <code>2</code>, and creates the <code>ThemeCommand</code> object which selects the application&#8217;s theme.
The <code>UserPref</code> stores and retrieves the theme preference of the application.</p>
</div>
<div class="paragraph">
<p><code>ThemeCommand</code> relies on <code>SetThemeRequestEvent</code> which is handled by <code>MainWindow</code> to call the appropriate method for setting of theme.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If there is no <code>INDEX</code> present, <code>theme</code> command will return an invalid message, which shows the usage information to the user.
(e.g. theme "").
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p><code>ThemeCommand</code> code snippet to check for valid <code>INDEX</code> input and raises the <code>SetThemeRequestEvent</code> handler for setting of the desired theme, based on the <code>INDEX</code> input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> CommandResult execute() <span class="directive">throws</span> CommandException {
        <span class="keyword">if</span> (selectedIndex.getZeroBased() &gt;= NUMBER_OF_THEMES) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(Messages.MESSAGE_INVALID_THEME_INDEX);
        }
        EventsCenter.getInstance().post(<span class="keyword">new</span> SetThemeRequestEvent(selectedIndex));
        <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_THEME_CHANGE_SUCCESS, selectedIndex.getOneBased()));
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ThemeCommandParser</code> code snippet to validate <code>INDEX</code> input, which returns <code>ThemeCommand</code> object if valid, and invalid message otherwise:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> ThemeCommand parse(<span class="predefined-type">String</span> args) <span class="directive">throws</span> <span class="exception">ParseException</span> {
        <span class="keyword">try</span> {
            Index index = ParserUtil.parseIndex(args);
            <span class="keyword">return</span> <span class="keyword">new</span> ThemeCommand(index);
        } <span class="keyword">catch</span> (IllegalValueException ive) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(
                    <span class="predefined-type">String</span>.format(MESSAGE_INVALID_COMMAND_FORMAT, ThemeCommand.MESSAGE_USAGE));
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>MainWindow</code> code snippet that handles <code>SetThemeRequestEvent</code> to set the theme of the application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">private</span> <span class="type">void</span> handleSetThemeRequestEvent(SetThemeRequestEvent event) <span class="directive">throws</span> CommandException {
        logger.info(LogsCenter.getEventHandlingLogMessage(event));
        setTheme(event.getSelectedIndex());
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>setTheme</code> method code snippet in <code>MainWindow</code> that checks for file existence before removing current theme and applying the selected theme. Selected theme is then updated in the <code>UserPref</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">private</span> <span class="type">void</span> setTheme(Index selectedIndex) <span class="directive">throws</span> CommandException {
        <span class="predefined-type">String</span> themeName = themes[selectedIndex.getZeroBased()];
        <span class="keyword">if</span> (MainApp.class.getResource(FXML_FILE_FOLDER + themeName + <span class="string"><span class="delimiter">&quot;</span><span class="content">Theme.css</span><span class="delimiter">&quot;</span></span>) == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(Messages.MESSAGE_INVALID_FILE_PATH);
        }

        getRoot().getScene().getStylesheets().clear();
        getRoot().getScene().getStylesheets().add(FXML_FILE_FOLDER + themeName + <span class="string"><span class="delimiter">&quot;</span><span class="content">Theme.css</span><span class="delimiter">&quot;</span></span>);
        getRoot().getScene().getStylesheets().add(FXML_FILE_FOLDER + <span class="string"><span class="delimiter">&quot;</span><span class="content">Extensions</span><span class="delimiter">&quot;</span></span> + themeName + <span class="string"><span class="delimiter">&quot;</span><span class="content">.css</span><span class="delimiter">&quot;</span></span>);
        prefs.setExtensionName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Extensions</span><span class="delimiter">&quot;</span></span> + themeName);
        prefs.setThemeName(themeName + <span class="string"><span class="delimiter">&quot;</span><span class="content">Theme</span><span class="delimiter">&quot;</span></span>);

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>setTheme</code> method code snippet in <code>MainApp</code> that initializes the application&#8217;s last selected theme:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">private</span> <span class="type">void</span> setTheme(Stage primaryStage) {
        primaryStage.getScene().getStylesheets().clear();
        primaryStage.getScene().getStylesheets().add(<span class="string"><span class="delimiter">&quot;</span><span class="content">/view/</span><span class="delimiter">&quot;</span></span> + userPrefs.getThemeName() + <span class="string"><span class="delimiter">&quot;</span><span class="content">.css</span><span class="delimiter">&quot;</span></span>);
        primaryStage.getScene().getStylesheets().add(<span class="string"><span class="delimiter">&quot;</span><span class="content">/view/</span><span class="delimiter">&quot;</span></span> + userPrefs.getExtensionName() + <span class="string"><span class="delimiter">&quot;</span><span class="content">.css</span><span class="delimiter">&quot;</span></span>);
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-4"><a class="link" href="#design-considerations-4">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-implementation-of-code-themecommand-code-br"><a class="link" href="#aspect-implementation-of-code-themecommand-code-br">Aspect: Implementation of <code>ThemeCommand</code><br></a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Current choice:</strong> Utilizing <code>SetThemRequestEvent</code> and allow <code>MainWindow</code> to handle the raised event to set the theme of the application.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Lesser responsibility for <code>ThemeCommand</code>.</p>
</li>
<li>
<p>Cons: Harder for new developer to understand the behavior of theme setting, as it utilizes event handling.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Alternative:</em> Instantiate <code>ThemeCommand</code> in <code>MainWindow</code> that passes <code>Stage</code> as a parameter. Then, perform theme setting in <code>ThemeCommand</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement.</p>
</li>
<li>
<p>Cons: Violates Law of Demeter as <code>ThemeCommand</code> has knowledge and access to <code>Stage</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-04-15 15:43:14 UTC
</div>
</div>
</body>
</html>